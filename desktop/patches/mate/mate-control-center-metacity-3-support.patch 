diff --git a/capplets/appearance/theme-installer.c b/capplets/appearance/theme-installer.c
index 2222639..d2832b3 100644
--- a/capplets/appearance/theme-installer.c
+++ b/capplets/appearance/theme-installer.c
@@ -129,6 +129,13 @@ file_theme_type (const gchar *dir)
 	if (exists)
 		return THEME_GTK;
 
+	filename = g_build_filename (dir, "metacity-1", "metacity-theme-3.xml", NULL);
+	exists = g_file_test (filename, G_FILE_TEST_IS_REGULAR);
+	g_free (filename);
+
+	if (exists)
+		return THEME_MARCO;
+
 	filename = g_build_filename (dir, "metacity-1", "metacity-theme-2.xml", NULL);
 	exists = g_file_test (filename, G_FILE_TEST_IS_REGULAR);
 	g_free (filename);
diff --git a/capplets/common/mate-theme-info.c b/capplets/common/mate-theme-info.c
index 01c83ee..d7aa9d9 100644
--- a/capplets/common/mate-theme-info.c
+++ b/capplets/common/mate-theme-info.c
@@ -938,7 +938,9 @@ marco_dir_changed (GFileMonitor              *monitor,
   affected_file = g_file_get_basename (file);
 
   /* The only file we care about is metacity-theme-(1|2).xml */
-  if (!strcmp (affected_file, "metacity-theme-1.xml") || !strcmp (affected_file, "metacity-theme-2.xml")) {
+  if (!strcmp (affected_file, "metacity-theme-1.xml") ||
+      !strcmp (affected_file, "metacity-theme-2.xml") ||
+      !strcmp (affected_file, "metacity-theme-3.xml")) {
     update_marco_index (file, monitor_data->priority);
   }
 
@@ -1055,16 +1057,24 @@ add_common_theme_dir_monitor (GFile                      *theme_dir_uri,
 
   /* marco theme subdir */
   subdir = g_file_get_child (theme_dir_uri, "metacity-1");
-  uri = g_file_get_child (subdir, "metacity-theme-2.xml");
+
+  uri = g_file_get_child (subdir, "metacity-theme-3.xml");
   if (g_file_query_exists (uri, NULL)) {
     update_marco_index (uri, monitor_data->priority);
   }
   else {
     g_object_unref (uri);
-    uri = g_file_get_child (subdir, "metacity-theme-1.xml");
+    uri = g_file_get_child (subdir, "metacity-theme-2.xml");
     if (g_file_query_exists (uri, NULL)) {
       update_marco_index (uri, monitor_data->priority);
     }
+    else {
+      g_object_unref (uri);
+      uri = g_file_get_child (subdir, "metacity-theme-1.xml");
+      if (g_file_query_exists (uri, NULL)) {
+        update_marco_index (uri, monitor_data->priority);
+      }
+    }
   }
   g_object_unref (uri);
 
diff --git a/libwindow-settings/marco-window-manager.c b/libwindow-settings/marco-window-manager.c
index 74b872c..432b1dc 100644
--- a/libwindow-settings/marco-window-manager.c
+++ b/libwindow-settings/marco-window-manager.c
@@ -121,7 +121,7 @@ add_themes_from_dir (GList *current_list, const char *path)
         }
 
         while ((entry = g_dir_read_name (theme_dir)) != NULL) {
-                theme_file_path = g_build_filename (path, entry, "metacity-1/metacity-theme-2.xml", NULL);
+                theme_file_path = g_build_filename (path, entry, "metacity-1/metacity-theme-3.xml", NULL);
 
                 if (g_file_test (theme_file_path, G_FILE_TEST_EXISTS)) {
 
@@ -135,7 +135,7 @@ add_themes_from_dir (GList *current_list, const char *path)
                 }
                 else {
                         g_free (theme_file_path);
-                        theme_file_path = g_build_filename (path, entry, "metacity-1/metacity-theme-1.xml", NULL);
+                        theme_file_path = g_build_filename (path, entry, "metacity-1/metacity-theme-2.xml", NULL);
 
                         if (g_file_test (theme_file_path, G_FILE_TEST_EXISTS)) {
 
@@ -147,6 +147,21 @@ add_themes_from_dir (GList *current_list, const char *path)
                                         current_list = g_list_prepend (current_list, g_strdup (entry));
                                 }
                         }
+                        else {
+                                g_free (theme_file_path);
+                                theme_file_path = g_build_filename (path, entry, "metacity-1/metacity-theme-1.xml", NULL);
+
+                                if (g_file_test (theme_file_path, G_FILE_TEST_EXISTS)) {
+
+                                        for (node = current_list; (node != NULL) && (!found); node = node->next) {
+                                                found = (strcmp (node->data, entry) == 0);
+                                        }
+
+                                        if (!found) {
+                                                current_list = g_list_prepend (current_list, g_strdup (entry));
+                                        }
+                                }
+                        }
                 }
 
                 found = FALSE;
